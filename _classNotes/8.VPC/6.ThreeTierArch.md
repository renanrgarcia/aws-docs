# Three-Tier Architecture

- A three-tier architecture is a well-known software architecture pattern that separates an application into three main logical layers:
  - Presentation Layer (Elastic Load Balancer in Multi-AZ)
  - Application Layer (Private Subnet with Auto Scaling Group and EC2 Instances)
  - Data Layer (Private Subnet with Amazon RDS, DynamoDB, and/or ElastiCache for session and cached data)

1. User queries the Route 53 DNS to get the IP address of the application.
2. The request is routed to the Elastic Load Balancer (ELB) in the public subnet, which distributes incoming traffic across multiple EC2 instances in the application layer.
3. The EC2 instances in the application layer process the request, perform necessary computations, and interact with the database layer to retrieve or store data.
4. The database layer, typically consisting of a managed database service like Amazon RDS or DynamoDB, handles data storage and retrieval operations.
5. If caching is needed, ElastiCache can be used to store frequently accessed data, reducing latency and improving performance.
6. The response is sent back through the ELB to the user.

- Benefits of a Three-Tier Architecture:
  - `Scalability`: Each layer can be scaled independently based on demand.
  - `Security`: Different security measures can be applied to each layer, such as using private subnets for the application and database layers.
  - `Maintainability`: Changes in one layer do not necessarily impact the others, making it easier to update and maintain the application.
  - `Flexibility`: Different technologies and services can be used for each layer, allowing for a more tailored solution to meet specific requirements.

# LAMP Stack Example

- **LAMP**: Linux, Apache, MySQL, PHP
- **Presentation Layer**: Amazon EC2 instances running Apache web server on top of Linux
- **Application Layer**: PHP applications running on EC2 instances
- **Data Layer**: Amazon RDS for MySQL database
- **Caching Layer(optional)**: Amazon ElastiCache (Redis/Memcached) for caching frequently accessed data
- **Storage Layer (optional)**: EBS Drive (root) to store application data & software
- **File Storage Layer (optional)**: Amazon EFS for shared file storage across multiple EC2 instances
  - EFS Mount Target: An entry point in a subnet that allows EC2 instances to access the EFS file system.

## WordPress Example

1. User queries the Route 53 DNS to get the IP address of the WordPress site.
2. The request is routed to the Elastic Load Balancer (ELB) in the public subnet (Multi-AZ), which distributes incoming traffic across multiple EC2 instances running WordPress in the application layer (in this example 2 instances in 2 AZs).
3. To provide communication between the EC2 instances, we use an Elastic File System (EFS) mounted on both instances to store WordPress files (themes, plugins, uploads).
4. The EC2 communicates with the EFS through an ENI (Elastic Network Interface) in the same AZ.
5. The EC2 instances in the application layer process the request, perform necessary computations, and interact with the database layer to retrieve or store data.

- A more complex example: https://aws.amazon.com/blogs/architecture/wordpress-best-practices-on-aws/
