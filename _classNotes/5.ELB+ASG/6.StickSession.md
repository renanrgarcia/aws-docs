# Sticky Sessions (Session Affinity)

- Concept: A feature that allows a load balancer to bind a user's session to a specific instance, ensuring that all requests from a user during a session are sent to the same instance.
- Works for CLB, ALB, and NLB.
- Useful for applications that store session data locally on the instance (e.g., shopping carts, user preferences).
- Implemented using cookies. They have a duration (expiration time) after which they are no longer valid that can be configured.
- Enabling sticky sessions can lead to uneven load distribution if some instances receive more traffic than others.

## Cookie Names

- **Application-based cookies**:
  - `Custom cookies` created by the application to track sessions.
    - Generated by the target (e.g., web server) and passed to the load balancer.
    - Can include any custom information required by the application.
    - Must be specified individually for each target group.
    - Don't use the names `AWSELB`, `AWSALB`, or `AWSALBTG`. Reserved for use by ELB.
  - `Application cookies` created by the load balancer to track sessions.
    - Created by the load balancer based on a cookie name specified in the target group.
    - Named `AWSALBAPP` for ALB.
    - The load balancer uses the specified cookie name to track sessions.
    - The application must generate and manage the cookie.
- **Duration-based cookies**: Managed by the load balancer.
  - Created by the load balancer to track sessions.
  - Named `AWSELB` for CLB and `AWSALB` for ALB.
  - The load balancer generates a unique cookie value for each session.
  - The duration (expiration time) can be configured (default is 5 minutes).

## How it works

1. Go to the EC2 console, then Load Balancing > Target Groups.
2. Select the target group and click on the "Attributes" tab.
3. In the "Attributes" tab, you can configure the sticky session settings.
   - For Load Balancer-generated cookies, enable the "Stickiness" option and set the duration (in seconds).
   - For Application-based cookies, enable the "Stickiness" option and specify the cookie name.
