# ELB (Elastic Load Balancing)

- Distributes incoming application traffic across multiple targets, such as EC2 instances, containers, and IP addresses.
- Automatically scales its request handling capacity in response to incoming traffic.

## Why to use ELB?

- To spread load across multiple instances, improving fault tolerance and availability.
- Expose a single point of access (DNS) to your application, even if the backend instances change.
  - It doesn't have a fixed IP, but a DNS name (e.g., my-load-balancer-1234567890.us-west-2.elb.amazonaws.com)
- Health checks: ELB can monitor the health of registered instances and route traffic only to healthy ones.
- Provides SSL termination, offloading the SSL decryption/encryption work from your instances.
- Enforce sticky sessions if needed, ensuring that a user's session is consistently routed to the same instance.
- High availability between multiple availability zones.
- Separate public and private traffic to your application.

## ELB Caracteristics

- ELB is a managed service.
  - AWS handles the maintenance, scaling, and availability of the load balancer.
  - Take care of scaling the load balancer as traffic to your application changes over time.
  - Provide a few configuration knobs to tune the behavior of the load balancer.
- It costs less to create your own load balancer, but it requires a lot more effort to maintain and scale it.
- It's integrated with many AWS services:
  - EC2, EC2 Auto Scaling Groups, ECS
  - AWS Certificate Manager (ACM) for SSL/TLS certificates, CloudWatch for monitoring
  - AWS WAF (Web Application Firewall) for security, Route 53 for DNS routing policies, AWS Global Accelerator for improved global performance

## Health Checks

- ELB can perform health checks on registered instances to ensure they are capable of handling requests.
- It is done by sending requests to a specified port and route on the instance and checking the response. (/health is a common route used for health checks)
- If it returns a successful response (like HTTP 200), the instance is considered healthy; otherwise, it's marked as unhealthy.

## Types of ELB

- **Classic Load Balancer (CLB) (v1 - old generation 2009)** [DEPRECATED]: The original ELB, supports both HTTP/HTTPS and TCP/SSL protocols. It operates at both the request level and connection level.
- **Application Load Balancer (ALB) (v2 - new generation 2016)**: Operates at the application layer (Layer 7), supports advanced routing features like path-based routing, host-based routing, and WebSocket support. Ideal for microservices and container-based architectures.
  - Supports HTTP/HTTPS and WebSocket protocols.
- **Network Load Balancer (NLB) (v2 - new generation 2017)**: Operates at the transport layer (Layer 4), designed to handle millions of requests per second while maintaining ultra-low latencies.
  - It supports TCP, UDP, and TLS (secure TCP) protocols. Ideal for high-performance applications and real-time streaming.
- **Gateway Load Balancer (GLB) (v2 - new generation 2020)**: Operates at Layer 3 (Network Layer), designed to deploy, scale, and manage third-party virtual appliances (like firewalls, intrusion detection systems, etc.) in a highly available manner.
  - It supports the GENEVE protocol, which encapsulates packets for transmission to the target appliances.
  - It works at layer 3 (network layer) and is used to route traffic to virtual appliances.
- It is recommended to use newer generation load balancers (ALB, NLB, GLB) for new applications due to their advanced features and better performance.
- Some load balancers can be set up as internet-facing (public) or internal (private) based on the use case.

## Security Groups

- ELB must be associated with security groups that allow inbound traffic on the ports the load balancer is listening on (e.g., 80 for HTTP, 443 for HTTPS).
  - Configs: type, protocol, port range, source (CIDR or security group) and description.
- The instances behind the ELB must also have security groups that allow inbound traffic from the ELB's security group on the ports the instances are listening on (e.g., 80 for HTTP). So the source will be the security group of the ELB.
