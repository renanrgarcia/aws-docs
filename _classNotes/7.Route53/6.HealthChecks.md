# Health Checks

- Monitor the health of public resources.
- Health check => Automatic DNS failover:
  1. Health checks that monitor an endpoint (application, server, other AWS resource).
  2. Health checks that monitor other health checks (calculated health checks).
  3. Health checks that monitor CloudWatch alarms (full control).
  - E.g., throttles of DynamoDB, alarms on RDS, custom metrics (helpful for private resources).
- Health checks are integrated with CW (CloudWatch) metrics.

## Monitoring Endpoints

- About 15 global health checkers (distributed around the world).
  - Healthy/Unhealthy threshold: 3/3 (default).
  - Interval: 30s (default). Can be set to 10s for an extra cost.
  - Support HTTP, HTTPS, TCP, and CloudWatch alarms.
  - If 18% of health checkers report unhealthy, the endpoint is considered unhealthy.
  - Ability to choose the region of health checkers (e.g., only US).
- Health checkers pass only when the endpoint responds with a 2xx or 3xx status code.
- They can be set up to pass/fail based on the text on the first 5120 bytes of the response.
- Configure your router/firewall to allow health checkers to access your endpoint.

## Calculated Health Checks

- Combine the results of two or more health checks.
- E.g., if you have two endpoints (A and B), you can create a calculated health check that is healthy only if both A and B are healthy.
- You can use AND, OR, and NOT logic to combine health checks.
- Can monitor up to 256 health checks.
- Specify the number of child health checks that must be healthy for the calculated health check to be considered healthy.
- Usage: complex failover scenarios, e.g., primary site with two endpoints and a secondary site with one endpoint.
  - Primary site is healthy if at least one of its endpoints is healthy.
  - Secondary site is healthy if its single endpoint is healthy.
  - Failover to the secondary site only if the primary site is unhealthy.
- Also can be used to perform maintenance to a website without causing all health checks to fail.

## Private Hosted Zones

- Route 53 health checkers are outside of the VPC, so they cannot access private resources or on-premises resources connected via Direct Connect or VPN.
- To monitor private resources, you can create a CloudWatch alarm based on a custom metric that you publish from within the VPC.
  - Then, create a Route 53 health check that is associated with the CloudWatch alarm.
